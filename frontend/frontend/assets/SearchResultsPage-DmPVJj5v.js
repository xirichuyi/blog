import{u as E,c as R,a as D,r as t,j as e,L as F}from"./index-Cfx8vNNh.js";import{A as T}from"./ArticleCard-8oAlXAIq.js";const $=()=>{const y=E(),[N,d]=R(),{isLoading:S,error:x,fetchArticles:g}=D(),[h,p]=t.useState([]),[a,m]=t.useState(N.get("q")||""),[n,j]=t.useState(!1),[l,b]=t.useState([]);t.useEffect(()=>{const s=async()=>{try{const r=await g(1,1e3);r&&b(r.articles)}catch(r){console.error("Failed to load articles for search:",r)}};l.length===0&&s()},[g,l.length]),t.useEffect(()=>{a.trim()&&l.length>0?f():p([])},[a,l]),t.useEffect(()=>{a.trim()?d({q:a}):d({})},[a,d]);const f=async()=>{j(!0);try{await new Promise(c=>setTimeout(c,300));let s=[...l];const r=a.toLowerCase().trim();r&&(s=s.filter(c=>{const o=c.title.toLowerCase().includes(r),i=c.excerpt.toLowerCase().includes(r),u=c.author.toLowerCase().includes(r),A=c.category.toLowerCase().includes(r),L=c.tags.some(k=>k.toLowerCase().includes(r));return o||i||u||A||L}),s.sort((c,o)=>new Date(o.publishDate).getTime()-new Date(c.publishDate).getTime())),p(s)}catch(s){console.error("Search error:",s)}finally{j(!1)}},w=s=>{s.preventDefault(),f()},v=s=>{y(`/article/${s}`)},C=(s,r)=>{if(!r.trim())return s;const c=new RegExp(`(${r})`,"gi");return s.split(c).map((i,u)=>c.test(i)?e.jsx("mark",{className:"search-highlight",children:i},u):i)};return S?e.jsx("div",{className:"search-results-page",children:e.jsx(F,{size:"large",message:"Loading...",className:"search-loading"})}):x?e.jsx("div",{className:"search-results-page",children:e.jsxs("div",{className:"search-error",children:[e.jsx("md-icon",{className:"error-icon",children:"error"}),e.jsx("h2",{className:"md-typescale-headline-medium",children:"Search Error"}),e.jsx("p",{className:"md-typescale-body-large",children:x}),e.jsx("md-filled-button",{onClick:()=>window.location.reload(),children:"Try Again"})]})}):e.jsxs("div",{className:"search-results-page",children:[e.jsxs("header",{className:"search-header",children:[e.jsx("h1",{className:"search-title md-typescale-display-small",children:"Search Results"}),e.jsxs("form",{className:"search-form",onSubmit:w,children:[e.jsxs("md-outlined-text-field",{label:"Search articles...",value:a,onInput:s=>m(s.target.value),class:"search-input",children:[e.jsx("md-icon",{slot:"leading-icon",children:"search"}),a&&e.jsx("md-icon-button",{slot:"trailing-icon",onClick:()=>m(""),"aria-label":"Clear search",children:e.jsx("md-icon",{children:"close"})})]}),e.jsx("md-filled-button",{type:"submit",disabled:n||!a.trim(),children:n?e.jsxs(e.Fragment,{children:[e.jsx("md-circular-progress",{indeterminate:!0,slot:"icon",style:{"--md-circular-progress-size":"18px"}}),"Searching..."]}):e.jsxs(e.Fragment,{children:[e.jsx("md-icon",{slot:"icon",children:"search"}),"Search"]})})]})]}),e.jsx("section",{className:"search-results",children:a.trim()?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"results-info",children:e.jsx("p",{className:"results-count md-typescale-body-medium",children:n?"Searching...":`Found ${h.length} results for "${a}"`})}),h.length>0?e.jsx("div",{className:"results-grid",children:h.map(s=>e.jsxs("div",{className:"search-result-card",children:[e.jsx(T,{...s,onClick:v,className:"search-article-card"}),e.jsx("div",{className:"search-snippet",children:e.jsx("p",{className:"snippet-text md-typescale-body-small",children:C(s.excerpt,a)})})]},s.id))}):n?null:e.jsxs("div",{className:"no-results",children:[e.jsx("md-icon",{className:"no-results-icon",children:"search_off"}),e.jsx("h3",{className:"md-typescale-headline-small",children:"No Results Found"}),e.jsxs("p",{className:"md-typescale-body-medium",children:['No articles found matching "',a,'". Try different keywords or adjust your filters.']}),e.jsxs("md-text-button",{onClick:()=>m(""),children:[e.jsx("md-icon",{slot:"icon",children:"refresh"}),"Clear Search"]})]})]}):e.jsxs("div",{className:"search-prompt",children:[e.jsx("md-icon",{className:"search-prompt-icon",children:"search"}),e.jsx("h3",{className:"md-typescale-headline-small",children:"Start Your Search"}),e.jsx("p",{className:"md-typescale-body-medium",children:"Enter keywords to search through articles, authors, categories, and tags."})]})})]})};export{$ as default};
