const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Cfx8vNNh.js","assets/index-CmW9tvWS.css"])))=>i.map(i=>d[i]);
import{j as e,_ as F,r as m,f as L,u as O,h as B,a as V,b as z}from"./index-Cfx8vNNh.js";import{A as M}from"./AdminLayout-DBr5zY72.js";import{E as U}from"./ErrorMessage-DFJp8pQE.js";var q=Object.defineProperty,G=(l,h,o)=>h in l?q(l,h,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[h]=o,$=(l,h,o)=>G(l,typeof h!="symbol"?h+"":h,o);const H=({open:l,title:h,message:o,confirmText:y="Confirm",cancelText:b="Cancel",type:u="info",icon:r,onConfirm:a,onCancel:g})=>{const[f,j]=m.useState(!1);m.useEffect(()=>(l?(j(!0),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.body.style.overflow=""}),[l]);const v=()=>{l||j(!1)},d=p=>{p.target===p.currentTarget&&g()},N=p=>{p.key==="Escape"?g():p.key==="Enter"&&a()},x=()=>{if(r)return r;switch(u){case"warning":return"warning";case"error":return"error";case"success":return"check_circle";default:return"info"}},w=()=>{switch(u){case"warning":return"var(--md-sys-color-tertiary)";case"error":return"var(--md-sys-color-error)";case"success":return"var(--md-sys-color-primary)";default:return"var(--md-sys-color-primary)"}};return f?L.createPortal(e.jsx("div",{className:`confirm-dialog-backdrop ${l?"open":"closing"}`,onClick:d,onAnimationEnd:v,children:e.jsxs("div",{className:`confirm-dialog ${l?"open":"closing"} confirm-dialog-${u}`,onKeyDown:N,tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":"dialog-title","aria-describedby":"dialog-message",children:[e.jsxs("div",{className:"confirm-dialog-header",children:[e.jsx("div",{className:"confirm-dialog-icon",style:{color:w()},children:e.jsx("md-icon",{children:x()})}),e.jsx("h2",{id:"dialog-title",className:"confirm-dialog-title md-typescale-headline-small",children:h})]}),e.jsx("div",{className:"confirm-dialog-content",children:e.jsx("p",{id:"dialog-message",className:"confirm-dialog-message md-typescale-body-medium",children:o})}),e.jsxs("div",{className:"confirm-dialog-actions",children:[e.jsx("md-text-button",{onClick:g,class:"cancel-button",children:b}),e.jsx("md-filled-button",{onClick:a,class:`confirm-button confirm-button-${u}`,children:y})]})]})}),document.body):null},I=class k{constructor(){$(this,"container",null),$(this,"currentDialog",null)}static getInstance(){return k.instance||(k.instance=new k),k.instance}createContainer(){return this.container||(this.container=document.createElement("div"),this.container.id="confirm-dialog-container",document.body.appendChild(this.container)),this.container}show(h){return new Promise(o=>{this.currentDialog&&this.currentDialog.resolve(!1);const y=this.createContainer(),b=()=>{this.currentDialog=null,o(!0),this.unmount()},u=()=>{this.currentDialog=null,o(!1),this.unmount()},r=e.jsx(H,{...h,open:!0,onConfirm:b,onCancel:u});this.currentDialog={resolve:o,component:r},typeof window<"u"&&window.React18Root?window.React18Root.createRoot(y).render(r):F(()=>import("./index-Cfx8vNNh.js").then(a=>a.i),__vite__mapDeps([0,1])).then(a=>{a.render(r,y)})})}unmount(){this.container&&setTimeout(()=>{this.container&&this.container.parentNode&&(this.container.parentNode.removeChild(this.container),this.container=null)},300)}};$(I,"instance");let J=I;const A=l=>J.getInstance().show(l),Q=({data:l,columns:h,actions:o=[],bulkActions:y=[],loading:b=!1,error:u,selectable:r=!1,pagination:a,onSort:g,emptyState:f,className:j="",rowKey:v="id"})=>{const[d,N]=m.useState(new Set),[x,w]=m.useState({key:null,direction:null}),p=(t,c)=>typeof v=="function"?v(t):t[v]||c.toString(),S=t=>{if(t){const c=l.map((s,i)=>p(s,i));N(new Set(c))}else N(new Set)},C=(t,c)=>{const s=new Set(d);c?s.add(t):s.delete(t),N(s)},D=t=>{if(!g)return;let c="asc";x.key===t&&(x.direction==="asc"?c="desc":x.direction==="desc"&&(c=null)),w({key:t,direction:c}),g(t,c)},P=async t=>{const c=l.filter((s,i)=>d.has(p(s,i)));t.confirmMessage&&!await A({title:"Confirm Action",message:t.confirmMessage.replace("{count}",c.length.toString()),confirmText:t.label,cancelText:"Cancel",type:"warning"})||(t.onClick(c),N(new Set))};m.useMemo(()=>l.filter((t,c)=>d.has(p(t,c))),[l,d,v]);const E=d.size===l.length&&l.length>0,_=d.size>0&&d.size<l.length;return b?e.jsxs("div",{className:"enhanced-table-loading",children:[e.jsx("md-circular-progress",{indeterminate:!0}),e.jsx("p",{className:"md-typescale-body-medium",children:"Loading data..."})]}):u?e.jsxs("div",{className:"enhanced-table-error",children:[e.jsx("md-icon",{class:"error-icon",children:"error"}),e.jsx("h3",{className:"md-typescale-headline-small",children:"Error Loading Data"}),e.jsx("p",{className:"md-typescale-body-medium",children:u})]}):e.jsxs("div",{className:`enhanced-data-table ${j}`,children:[r&&d.size>0&&y.length>0&&e.jsxs("div",{className:"bulk-actions-bar",children:[e.jsxs("div",{className:"bulk-actions-info",children:[e.jsx("md-icon",{children:"check_circle"}),e.jsxs("span",{className:"md-typescale-body-medium",children:[d.size," item",d.size>1?"s":""," selected"]})]}),e.jsx("div",{className:"bulk-actions-buttons",children:y.map(t=>e.jsxs("md-text-button",{onClick:()=>P(t),class:`bulk-action-${t.color||"primary"}`,children:[e.jsx("md-icon",{slot:"icon",children:t.icon}),t.label]},t.key))})]}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"enhanced-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[r&&e.jsx("th",{className:"select-column",children:e.jsx("md-checkbox",{checked:E,indeterminate:_,onChange:t=>S(t.target.checked)})}),h.map(t=>e.jsx("th",{className:`table-header ${t.align||"left"} ${t.sortable?"sortable":""}`,style:{width:t.width},onClick:()=>t.sortable&&D(t.key),children:e.jsxs("div",{className:"header-content",children:[e.jsx("span",{className:"md-typescale-title-small",children:t.title}),t.sortable&&e.jsx("md-icon",{class:`sort-icon ${x.key===t.key?x.direction==="asc"?"sort-asc":"sort-desc":"sort-none"}`,children:x.key===t.key?x.direction==="asc"?"arrow_upward":"arrow_downward":"unfold_more"})]})},t.key)),o.length>0&&e.jsx("th",{className:"actions-column",children:e.jsx("span",{className:"md-typescale-title-small",children:"Actions"})})]})}),e.jsx("tbody",{children:l.map((t,c)=>{const s=p(t,c),i=d.has(s);return e.jsxs("tr",{className:`table-row ${i?"selected":""}`,children:[r&&e.jsx("td",{className:"select-column",children:e.jsx("md-checkbox",{checked:i,onChange:n=>C(s,n.target.checked)})}),h.map(n=>e.jsx("td",{className:`table-cell ${n.align||"left"}`,children:n.render?n.render(t[n.key],t,c):t[n.key]},n.key)),o.length>0&&e.jsx("td",{className:"actions-column",children:e.jsx("div",{className:"row-actions",children:o.map(n=>e.jsx("md-icon-button",{onClick:()=>n.onClick(t),disabled:n.disabled?.(t),class:`action-${n.color||"primary"}`,title:n.label,children:e.jsx("md-icon",{children:n.icon})},n.key))})})]},s)})})]})}),l.length===0&&f&&e.jsxs("div",{className:"empty-state",children:[f.icon&&e.jsx("md-icon",{class:"empty-icon",children:f.icon}),e.jsx("h3",{className:"md-typescale-headline-small",children:f.title}),f.description&&e.jsx("p",{className:"md-typescale-body-medium",children:f.description}),f.action&&e.jsx("md-filled-button",{onClick:f.action.onClick,children:f.action.label})]}),a&&e.jsxs("div",{className:"table-pagination",children:[e.jsx("div",{className:"pagination-info",children:e.jsxs("span",{className:"md-typescale-body-small",children:["Showing ",(a.current-1)*a.pageSize+1," to"," ",Math.min(a.current*a.pageSize,a.total)," of"," ",a.total," entries"]})}),e.jsxs("div",{className:"pagination-controls",children:[a.showSizeChanger&&e.jsx("select",{value:a.pageSize.toString(),onChange:t=>a.onPageChange(1,parseInt(t.target.value)),className:"page-size-selector",children:(a.pageSizeOptions||[10,20,50,100]).map(t=>e.jsxs("option",{value:t.toString(),children:[t," / page"]},t))}),e.jsxs("div",{className:"page-controls",children:[e.jsx("button",{className:"page-nav-button",disabled:a.current<=1,onClick:()=>a.onPageChange(a.current-1,a.pageSize),"aria-label":"Previous page",children:e.jsx("md-icon",{children:"chevron_left"})}),e.jsxs("span",{className:"md-typescale-body-medium",children:["Page ",a.current," of ",Math.ceil(a.total/a.pageSize)]}),e.jsx("button",{className:"page-nav-button",disabled:a.current>=Math.ceil(a.total/a.pageSize),onClick:()=>a.onPageChange(a.current+1,a.pageSize),"aria-label":"Next page",children:e.jsx("md-icon",{children:"chevron_right"})})]})]})]})]})},Z=()=>{const[l,h]=m.useState([]),[o,y]=m.useState(!0),[b,u]=m.useState(null),[r,a]=m.useState({search:"",category:"",status:"all"}),[g,f]=m.useState({current:1,pageSize:10,total:0}),[j,v]=m.useState({key:null,direction:null}),d=O(),{showNotification:N}=B(),{categories:x}=V();m.useEffect(()=>{w()},[g.current,g.pageSize,r,j]);const w=async()=>{try{y(!0),u(null);const s={page:g.current,page_size:g.pageSize};r.search&&(s.search=r.search),r.category&&(s.category=r.category),r.status!=="all"&&(s.status=r.status),j.key&&j.direction&&(s.sort_by=j.key,s.sort_order=j.direction);const i=await z.getPosts(s);if(i.success&&i.data)h(i.data),f(n=>({...n,total:i.total||i.data.length}));else throw new Error(i.error||"Failed to load posts")}catch(s){u(s instanceof Error?s.message:"Failed to load posts")}finally{y(!1)}},p=()=>{d("/admin/posts/new")},S=async s=>{if(await A({title:"Delete Post",message:`Are you sure you want to delete "${s.title}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",type:"error"}))try{const n=await z.deletePost(s.id);if(n.success)w(),N({type:"success",title:"Post Deleted",message:"Post deleted successfully."});else throw new Error(n.error||"Failed to delete post")}catch(n){u(n instanceof Error?n.message:"Failed to delete post")}},C=async s=>{if(await A({title:"Delete Posts",message:`Are you sure you want to delete ${s.length} posts? This action cannot be undone.`,confirmText:"Delete All",cancelText:"Cancel",type:"error"}))try{const n=s.map(R=>R.id),T=await z.bulkDeletePosts(n);if(T.success)w(),N({type:"success",title:"Posts Deleted",message:`${s.length} post${s.length>1?"s":""} deleted successfully.`});else throw new Error(T.error||"Failed to delete posts")}catch(n){u(n instanceof Error?n.message:"Failed to delete posts")}},D=m.useMemo(()=>[{key:"title",title:"Title",sortable:!0,render:(s,i)=>e.jsxs("div",{className:"post-title-cell",children:[e.jsx("h3",{className:"md-typescale-title-medium",children:i.title}),e.jsx("p",{className:"md-typescale-body-small",children:i.excerpt}),i.featured&&e.jsxs("md-assist-chip",{class:"featured-chip",children:[e.jsx("md-icon",{slot:"icon",children:"star"}),"Featured"]})]})},{key:"category",title:"Category",sortable:!0,render:s=>e.jsx("md-assist-chip",{children:s})},{key:"publishDate",title:"Date",sortable:!0,render:s=>c(s)},{key:"status",title:"Status",sortable:!0,render:s=>e.jsx("md-assist-chip",{class:`status-${s||"draft"}`,children:s==="published"?"Published":s==="draft"?"Draft":s==="private"?"Private":"Draft"})}],[]),P=m.useMemo(()=>[{key:"edit",label:"Edit",icon:"edit",onClick:s=>d(`/admin/posts/edit/${s.id}`),color:"primary"},{key:"delete",label:"Delete",icon:"delete",onClick:S,color:"error"}],[d]),E=m.useMemo(()=>[{key:"delete",label:"Delete Selected",icon:"delete",onClick:C,color:"error",confirmMessage:"Are you sure you want to delete {count} posts?"}],[C]),_=(s,i)=>{f(n=>({...n,current:s,pageSize:i}))},t=(s,i)=>{v({key:s,direction:i})},c=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return o?e.jsx(M,{title:"Post Management",children:e.jsxs("div",{className:"post-management-loading",children:[e.jsx("md-circular-progress",{indeterminate:!0}),e.jsx("p",{className:"md-typescale-body-medium",children:"Loading posts..."})]})}):b?e.jsx(M,{title:"Post Management",children:e.jsx(U,{title:"Error Loading Posts",message:b,onRetry:w})}):e.jsx(M,{title:"Post Management",children:e.jsxs("div",{className:"post-management",children:[e.jsxs("div",{className:"post-header",children:[e.jsxs("div",{className:"post-header-title",children:[e.jsx("h1",{className:"md-typescale-display-small",children:"Posts"}),e.jsx("p",{className:"md-typescale-body-large",children:"Manage your blog posts and content"})]}),e.jsx("div",{className:"post-header-actions",children:e.jsxs("md-filled-button",{onClick:p,children:[e.jsx("md-icon",{slot:"icon",children:"add"}),"New Post"]})})]}),e.jsxs("div",{className:"post-filters",children:[e.jsx("md-outlined-text-field",{label:"Search posts...",value:r.search,onInput:s=>a({...r,search:s.target.value}),class:"search-field",children:e.jsx("md-icon",{slot:"leading-icon",children:"search"})}),e.jsxs("md-outlined-select",{label:"Category",value:r.category,onInput:s=>a({...r,category:s.target.value}),children:[e.jsx("md-select-option",{value:"",children:"All Categories"}),x.filter(s=>s.id!=="all").map(s=>e.jsx("md-select-option",{value:s.id,children:s.name},s.id))]}),e.jsxs("md-outlined-select",{label:"Status",value:r.status,onInput:s=>a({...r,status:s.target.value}),children:[e.jsx("md-select-option",{value:"all",children:"All Posts"}),e.jsx("md-select-option",{value:"published",children:"Published"}),e.jsx("md-select-option",{value:"draft",children:"Draft"})]})]}),e.jsx(Q,{data:l,columns:D,actions:P,bulkActions:E,loading:o,error:b||void 0,selectable:!0,pagination:{current:g.current,pageSize:g.pageSize,total:g.total,showSizeChanger:!0,pageSizeOptions:[10,20,50,100],onPageChange:_},onSort:t,emptyState:{icon:"article",title:"No posts found",description:r.search||r.category?"Try adjusting your filters":"Create your first post to get started",action:!r.search&&!r.category?{label:"Create Post",onClick:p}:void 0},className:"posts-table"})]})})};export{Z as default};
